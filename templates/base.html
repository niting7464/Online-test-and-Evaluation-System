<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}Online Test System{% endblock %}</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    {% load static %}
    <link rel="stylesheet" href="{% static 'css/auth.css' %}">
</head>
<body class="bg-light">

<nav class="navbar navbar-dark bg-dark">
  <div class="container d-flex justify-content-between">
    <span class="navbar-brand">Online Test System</span>

    {% if current_user and current_user.is_authenticated %}
  <div>
    <span class="text-white me-3">
      {{ current_user.username }}
    </span>
    <a href="/logout/" class="btn btn-sm btn-outline-light">Logout</a>
  </div>
{% endif %}

  </div>
</nav>


{# Toast container: fixed, does not shift page layout #}
<div class="toast-container position-fixed bottom-0 start-50 translate-middle-x pb-3" id="toast-container" aria-live="polite" aria-atomic="true">
  {% for message in messages %}
    <div class="toast align-items-center text-bg-{{ message.tags }} border-0 mb-2" role="alert" aria-live="assertive" aria-atomic="true">
      <div class="d-flex">
        <div class="toast-body">{{ message|safe }}</div>
        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
      </div>
    </div>
  {% endfor %}
</div>

<div class="container mt-5">
    {% block content %}{% endblock %}
</div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        // Initialize and show all Bootstrap toasts from the container
        var toasts = document.querySelectorAll('#toast-container .toast');
        toasts.forEach(function (t) {
          try {
            var bs = bootstrap.Toast.getOrCreateInstance(t, { delay: 2500, autohide: true });
            bs.show();
          } catch (err) {
            // fallback: remove after timeout
            setTimeout(function () { t.remove(); }, 2500);
          }
        });

        // Close toast when CTA inside it is clicked
        document.body.addEventListener('click', function (e) {
          var target = e.target;
          if (target && target.classList && target.classList.contains('cta-dismiss')) {
            var toastEl = target.closest('.toast');
            if (toastEl) {
              try {
                bootstrap.Toast.getOrCreateInstance(toastEl).hide();
              } catch (err) {
                toastEl.remove();
              }
            }
          }
        }, false);
      });
    </script>
</body>
</html>
